/**
* Bloggy Javascript
*/function api(e,t,n,r){$.ajax({url:e,method:t,data:n,dataType:"json",success:function(e){r(e)},error:function(t){console.log("Bloggy: API Error for action: "+e);console.log(t)}})}function editor(){if($("[contenteditable]").length>0){$("body").append('<div class="bloggyEditorToolbar"><button type="button" data-type="left"><i class="fa fa-align-left"></i></button><button type="button" data-type="right"><i class="fa fa-align-right"></i></button><button type="button" data-type="center"><i class="fa fa-align-center"></i></button><button type="button" data-type="bold"><i class="fa fa-bold"></i></button><button type="button" data-type="italic"><i class="fa fa-italic"></i></button><button type="button" data-type="link"><i class="fa fa-link"></i></button><button type="button" data-type="unlink"><i class="fa fa-unlink"></i></button><button type="button" data-type="list-ul"><i class="fa fa-list-ul"></i></button><button type="button" data-type="list-ol"><i class="fa fa-list-ol"></i></button><button type="button" data-type="image"><i class="fa fa-picture-o"></i></button><button type="button" data-type="undo"><i class="fa fa-undo"></i></button><button type="button" data-type="redo"><i class="fa fa-repeat"></i></button></div>');var e="3px",t="#00c0e4",n=$(".bloggyEditorToolbar");n.css({display:"none",position:"absolute","-webkit-border-radius":e,"-moz-border-radius":e,"border-radius":e,textAlign:"center"});n.find("button").css({margin:3,padding:"5px 10px",background:t,color:"#fff",outline:0,border:0,"-webkit-border-radius":e,"-moz-border-radius":e,"border-radius":e});n.find("button").click(function(){var e=currentSelection("content"),t=$(this);if(e!==null){var n=t.data("type");n==="left"&&document.execCommand("justifyleft");n==="right"&&document.execCommand("justifyright");n==="center"&&document.execCommand("justifycenter");n==="bold"&&document.execCommand("bold");n==="italic"&&document.execCommand("italic");n==="link"&&document.execCommand("CreateLink",!0,"http://www.mbl.is");n==="unlink"&&document.execCommand("unlink");n==="list-ul"&&document.execCommand("insertunorderedlist");n==="list-ol"&&document.execCommand("insertorderedlist");n==="undo"&&document.execCommand("undo");n==="redo"&&document.execCommand("redo")}});return n}return null}var currentSelection=function(e){var t=!1,n="";window.getSelection?n=window.getSelection():document.getSelection?n=document.getSelection():document.selection&&(n=document.selection.createRange().text);return $(n.anchorNode).closest("section#content")!==undefined?n:null};$(function(){var e=editor();$("[contenteditable]").each(function(){var e=$(this),t="0px 0px 10px rgba(0,0,0,.1)",n="1px dashed #e74c3c",r="1px dashed #2ecc71",i=function(){var t=e.html();t===undefined||t.length===0?e.css({border:n}):e.css({border:r})};e.css({padding:"3px",border:n,"box-shadow":t,"-webkit-box-shadow":t,"-moz-box-shadow":t,"-o-box-shadow":t,"-ms-box-shadow":t});e.keypress(function(){i()});e.blur(function(){i()})});e!==null&&$("#content[contenteditable]").focus(function(){var t=$(this);t.animate({marginTop:e.height()},function(){e.css({top:t.offset().top-e.height(),left:t.offset().left,width:t.width(),maxWidth:t.width()});e.fadeIn()})});$("[data-click=publish]").click(function(){var e=$("#title").html(),t=$("#content").html();api("/api/create","post",{title:e,content:t},function(e){if(e.response)window.location="/blog/"+e.id;else{console.log("BLOGGY ERROR:");console.log(e.message)}})});$("[data-click=save]").click(function(){var e=$("#title").html(),t=$("#content").html(),n=$("#id").val();api("/api/edit/"+n,"post",{title:e,content:t},function(e){if(e.response)window.location="/blog/"+e.id;else{console.log("BLOGGY ERROR:");console.log(e.message)}})})});